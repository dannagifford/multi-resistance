source("plot_simulations_N.R")
?ggsave
ggsave("Nproportions.pdf", Nproportions.plot, height = 2, width = 5)
ggsave("Nproportions.pdf", Nproportions.plot, height = 2, width = 7)
Nproportions.plot = proportions.mean %>%
ungroup() %>%
filter(time == max(time)) %>%
ggplot(aes(x=5.71*10^N, y=proportion.mean, fill = strain, shape = strain)) +
#geom_bar(stat="identity", position="dodge") +
geom_errorbar(aes(ymin = proportion.mean - proportion.sd,
ymax = proportion.mean + proportion.sd,
colour = strain),
#position = position_dodge(0.9),
width = 0) +
geom_point(size = 2) +
scale_shape_manual(values = c(21, 22, 23, 24), name = "Strain") +
facet_grid(~treatment) +
scale_colour_manual(values = bestcolours2[c(1:3,5)], name = "Strain") +
scale_fill_manual(values = bestcolours[c(1:3,5)], name = "Strain") +
labs(x="Simulated maximum population size", y="Mean proportion of each strain\nwithin populations (±sd)") +
scale_x_log10(labels = trans_format("log10", math_format(10^.x))) +
scale_y_continuous(labels = labelzero)
ggsave("Nproportions.pdf", Nproportions.plot, height = 2, width = 7)
Nproportions.plot = proportions.mean %>%
ungroup() %>%
filter(time == max(time)) %>%
ggplot(aes(x=5.71*10^N, y=proportion.mean, fill = strain, shape = strain)) +
#geom_bar(stat="identity", position="dodge") +
geom_errorbar(aes(ymin = proportion.mean - proportion.sd,
ymax = proportion.mean + proportion.sd,
colour = strain),
#position = position_dodge(0.9),
width = 0) +
geom_point(size = 3) +
scale_shape_manual(values = c(21, 22, 23, 24), name = "Strain") +
facet_grid(~treatment) +
scale_colour_manual(values = bestcolours2[c(1:3,5)], name = "Strain") +
scale_fill_manual(values = bestcolours[c(1:3,5)], name = "Strain") +
labs(x="Simulated maximum population size", y="Mean proportion of each strain\nwithin populations (±sd)") +
scale_x_log10(labels = trans_format("log10", math_format(10^.x))) +
scale_y_continuous(labels = labelzero)
ggsave("Nproportions.pdf", Nproportions.plot, height = 2, width = 7)
Nproportions.plot = proportions.mean %>%
ungroup() %>%
filter(time == max(time)) %>%
ggplot(aes(x=5.71*10^N, y=proportion.mean, fill = strain, shape = strain)) +
#geom_bar(stat="identity", position="dodge") +
geom_errorbar(aes(ymin = proportion.mean - proportion.sd,
ymax = proportion.mean + proportion.sd,
colour = strain),
#position = position_dodge(0.9),
width = 0) +
geom_point(size = 2) +
scale_shape_manual(values = c(21, 22, 23, 24), name = "Strain") +
facet_grid(~treatment) +
scale_colour_manual(values = bestcolours2[c(1:3,5)], name = "Strain") +
scale_fill_manual(values = bestcolours[c(1:3,5)], name = "Strain") +
labs(x="Simulated maximum population size", y="Mean proportion of each strain\nwithin populations (±sd)") +
scale_x_log10(labels = trans_format("log10", math_format(10^.x))) +
scale_y_continuous(labels = labelzero)
ggsave("Nproportions.pdf", Nproportions.plot, height = 2, width = 7)
Nproportions.plot = proportions.mean %>%
ungroup() %>%
filter(time == max(time)) %>%
ggplot(aes(x=5.71*10^N, y=proportion.mean, fill = strain, shape = strain)) +
#geom_bar(stat="identity", position="dodge") +
geom_errorbar(aes(ymin = proportion.mean - proportion.sd,
ymax = proportion.mean + proportion.sd,
colour = strain),
#position = position_dodge(0.9),
width = 0) +
geom_point(size = 2) +
scale_shape_manual(values = c(21, 22, 23, 24), name = "Strain") +
facet_grid(pmutS.text~treatment) +
scale_colour_manual(values = bestcolours2[c(1:3,5)], name = "Strain") +
scale_fill_manual(values = bestcolours[c(1:3,5)], name = "Strain") +
labs(x="Simulated maximum population size", y="Mean proportion of each strain\nwithin populations (±sd)") +
scale_x_log10(labels = trans_format("log10", math_format(10^.x))) +
scale_y_continuous(labels = labelzero)
ggsave("Nproportions.pdf", Nproportions.plot, height = 3, width = 7)
Nproportions.plot = proportions.mean %>%
ungroup() %>%
filter(time == max(time)) %>%
ggplot(aes(x=5.71*10^N, y=proportion.mean, fill = strain, shape = strain)) +
#geom_bar(stat="identity", position="dodge") +
geom_errorbar(aes(ymin = proportion.mean - proportion.sd,
ymax = proportion.mean + proportion.sd,
colour = strain),
#position = position_dodge(0.9),
width = 0) +
geom_point(size = 2) +
scale_shape_manual(values = c(21, 22, 23, 24), name = "Strain") +
facet_grid(pmutS.text~treatment) +
scale_colour_manual(values = bestcolours2[c(1:3,5)], name = "Strain") +
scale_fill_manual(values = bestcolours[c(1:3,5)], name = "Strain") +
labs(x="Simulated maximum population size", y="Mean proportion of each strain\nwithin populations (±sd)") +
scale_x_log10(labels = trans_format("log10", math_format(10^.x))) +
scale_y_continuous(labels = labelzero)
ggsave("Nproportions.pdf", Nproportions.plot, height = 2.5, width = 7)
Nproportions.plot = proportions.mean %>%
ungroup() %>%
filter(time == max(time)) %>%
ggplot(aes(x=5.71*10^N, y=proportion.mean, fill = strain, shape = strain)) +
#geom_bar(stat="identity", position="dodge") +
geom_errorbar(aes(ymin = proportion.mean - proportion.sd,
ymax = proportion.mean + proportion.sd,
colour = strain),
#position = position_dodge(0.9),
width = 0) +
geom_point(size = 2) +
scale_shape_manual(values = c(21, 22, 23, 24), name = "Strain") +
facet_grid(pmutS.text~treatment) +
scale_colour_manual(values = bestcolours2[c(1:3,5)], name = "Strain") +
scale_fill_manual(values = bestcolours[c(1:3,5)], name = "Strain") +
labs(x="Simulated maximum population size", y="Mean proportion\nwithin populations (±sd)") +
scale_x_log10(labels = trans_format("log10", math_format(10^.x))) +
scale_y_continuous(labels = labelzero)
ggsave("Nproportions.pdf", Nproportions.plot, height = 2.5, width = 7)
Nproportions.plot = proportions.mean %>%
ungroup() %>%
filter(time == max(time)) %>%
ggplot(aes(x=5.71*10^N, y=proportion.mean, fill = strain, shape = strain)) +
#geom_bar(stat="identity", position="dodge") +
geom_errorbar(aes(ymin = proportion.mean - proportion.sd,
ymax = proportion.mean + proportion.sd,
colour = strain),
#position = position_dodge(0.9),
width = 0) +
geom_point(size = 2) +
scale_shape_manual(values = c(21, 22, 23, 24), name = "Strain") +
facet_grid(pmutS.text~treatment) +
scale_colour_manual(values = bestcolours2[c(1:3,5)], name = "Strain") +
scale_fill_manual(values = bestcolours[c(1:3,5)], name = "Strain") +
labs(x="Simulated maximum population size", y="Mean proportion\nwithin populations") +
scale_x_log10(labels = trans_format("log10", math_format(10^.x))) +
scale_y_continuous(labels = labelzero)
ggsave("Nproportions.pdf", Nproportions.plot, height = 2, width = 7)
ggsave("Nproportions.pdf", Nproportions.plot, height = 2, width = 8)
# Plots
bestcolours = c("grey90", "#469067", "#235161", "#6f2c3d", "#ef0358")
bestcolours2 = c("black", bestcolours[-1])
Nproportions.plot = proportions.mean %>%
ungroup() %>%
filter(time == max(time)) %>%
ggplot(aes(x=5.71*10^N, y=proportion.mean, fill = strain, shape = strain)) +
#geom_bar(stat="identity", position="dodge") +
geom_errorbar(aes(ymin = proportion.mean - proportion.sd,
ymax = proportion.mean + proportion.sd,
colour = strain),
#position = position_dodge(0.9),
width = 0) +
geom_point(size = 2) +
geom_line(size = 2, aes(colour = strain)) +
scale_shape_manual(values = c(21, 22, 23, 24), name = "Strain") +
facet_grid(pmutS.text~treatment) +
scale_colour_manual(values = bestcolours2[c(1:3,5)], name = "Strain") +
scale_fill_manual(values = bestcolours[c(1:3,5)], name = "Strain") +
labs(x="Simulated maximum population size", y="Mean proportion\nwithin populations") +
scale_x_log10(labels = trans_format("log10", math_format(10^.x))) +
scale_y_continuous(labels = labelzero, limits = c(0,1), sec.axis = sec_axis(~ ., breaks = NULL, labels = NULL, name = "Initiial mutator frequency"))
lrequire(tidyverse)
require(ggpubr)
require(tidyverse)
require(ggpubr)
require(tidyverse)
require(grid)
require(scales)
# Plots
bestcolours = c("grey90", "#469067", "#235161", "#6f2c3d", "#ef0358")
bestcolours2 = c("black", bestcolours[-1])
Nproportions.plot = proportions.mean %>%
ungroup() %>%
filter(time == max(time)) %>%
ggplot(aes(x=5.71*10^N, y=proportion.mean, fill = strain, shape = strain)) +
#geom_bar(stat="identity", position="dodge") +
geom_errorbar(aes(ymin = proportion.mean - proportion.sd,
ymax = proportion.mean + proportion.sd,
colour = strain),
#position = position_dodge(0.9),
width = 0) +
geom_point(size = 2) +
geom_line(size = 2, aes(colour = strain)) +
scale_shape_manual(values = c(21, 22, 23, 24), name = "Strain") +
facet_grid(pmutS.text~treatment) +
scale_colour_manual(values = bestcolours2[c(1:3,5)], name = "Strain") +
scale_fill_manual(values = bestcolours[c(1:3,5)], name = "Strain") +
labs(x="Simulated maximum population size", y="Mean proportion\nwithin populations") +
scale_x_log10(labels = trans_format("log10", math_format(10^.x))) +
scale_y_continuous(labels = labelzero, limits = c(0,1), sec.axis = sec_axis(~ ., breaks = NULL, labels = NULL, name = "Initiial mutator frequency"))
ggsave("Nproportions.pdf", Nproportions.plot, height = 2, width = 8)
warnings()
Nproportions.plot = proportions.mean %>%
ungroup() %>%
filter(time == max(time)) %>%
ggplot(aes(x=5.71*10^N, y=proportion.mean, fill = strain, shape = strain)) +
#geom_bar(stat="identity", position="dodge") +
geom_errorbar(aes(ymin = proportion.mean - proportion.sd,
ymax = proportion.mean + proportion.sd,
colour = strain),
#position = position_dodge(0.9),
width = 0) +
geom_line(aes(colour = strain)) +
geom_point(size = 2) +
scale_shape_manual(values = c(21, 22, 23, 24), name = "Strain") +
facet_grid(pmutS.text~treatment) +
scale_colour_manual(values = bestcolours2[c(1:3,5)], name = "Strain") +
scale_fill_manual(values = bestcolours[c(1:3,5)], name = "Strain") +
labs(x="Simulated maximum population size", y="Mean proportion\nwithin populations") +
scale_x_log10(labels = trans_format("log10", math_format(10^.x))) +
scale_y_continuous(labels = labelzero, limits = c(0,1), sec.axis = sec_axis(~ ., breaks = NULL, labels = NULL, name = "Initiial mutator frequency"))
ggsave("Nproportions.pdf", Nproportions.plot, height = 2, width = 8)
source("plot_simulations_N.R")
Nproportions.plot = proportions.mean %>%
ungroup() %>%
filter(time == max(time)) %>%
ggplot(aes(x=5.71*10^N, y=proportion.mean, fill = strain, shape = strain)) +
#geom_bar(stat="identity", position="dodge") +
geom_errorbar(aes(ymin = proportion.mean - proportion.sd,
ymax = proportion.mean + proportion.sd,
colour = strain),
#position = position_dodge(0.9),
width = 0) +
geom_line(aes(colour = strain)) +
geom_point(size = 2) +
scale_shape_manual(values = c(21, 22, 23, 24), name = "Strain") +
facet_grid(~treatment) +
scale_colour_manual(values = bestcolours2[c(1:3,5)], name = "Strain") +
scale_fill_manual(values = bestcolours[c(1:3,5)], name = "Strain") +
labs(x="Simulated maximum population size", y="Mean proportion\nwithin populations") +
scale_x_log10(labels = trans_format("log10", math_format(10^.x))) +
scale_y_continuous(labels = labelzero, limits = c(0,1), sec.axis = sec_axis(~ ., breaks = NULL, labels = NULL, name = "Initiial mutator frequency"))
ggsave("Nproportions.pdf", Nproportions.plot, height = 2, width = 8)
Nproportions.plot = proportions.mean %>%
ungroup() %>%
filter(time == max(time)) %>%
ggplot(aes(x=5.71*10^N, y=proportion.mean, fill = strain, shape = strain)) +
#geom_bar(stat="identity", position="dodge") +
geom_errorbar(aes(ymin = proportion.mean - proportion.sd,
ymax = proportion.mean + proportion.sd,
colour = strain),
#position = position_dodge(0.9),
width = 0) +
geom_line(aes(colour = strain)) +
geom_point(size = 2) +
scale_shape_manual(values = c(21, 22, 23, 24), name = "Strain") +
facet_grid(~treatment) +
scale_colour_manual(values = bestcolours2[c(1:3,5)], name = "Strain") +
scale_fill_manual(values = bestcolours[c(1:3,5)], name = "Strain") +
labs(x="Simulated maximum population size", y="Mean proportion\nwithin populations") +
scale_x_log10(labels = trans_format("log10", math_format(10^.x))) +
scale_y_continuous(labels = labelzero, limits = c(0,1))
ggsave("Nproportions.pdf", Nproportions.plot, height = 2, width = 8)
